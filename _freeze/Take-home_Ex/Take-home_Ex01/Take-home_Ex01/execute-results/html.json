{
  "hash": "255f1c0c9a17e6db9ec979bf90406c6a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home_Ex01\"\ndate: 2025-04-29\ndate-modified: \"last-modified\"\nformat: html\neditor: visual\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork,\n               ggthemes, hrbrthemes,\n               tidyverse,stringr,\n               knitr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsg_data <- read_csv(\"data/respopagesex2024.csv\")\n```\n:::\n\n\n\n:::: columns\n::: {.column width=\"50%\"}\n### Categorical Variables\n\n-   PA: Planning Area\n-   SZ: Subzone\n-   Age: Single Year of Age\n-   Sex\n:::\n\n::: {.column width=\"50%\"}\n### Continuous Variables\n\n-   Pop: Resident Count\n-   Time: Time / Period\n:::\n::::\n\n::: {.callout-note appearance=\"simple\" collapse=\"true\"}\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(sg_data, class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         PA          SZ         Age         Sex         Pop        Time \n\"character\" \"character\" \"character\" \"character\"   \"numeric\"   \"numeric\" \n```\n\n\n:::\n:::\n\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|PA         |SZ                     |Age |Sex     | Pop| Time|\n|:----------|:----------------------|:---|:-------|---:|----:|\n|Ang Mo Kio |Ang Mo Kio Town Centre |0   |Males   |  10| 2024|\n|Ang Mo Kio |Ang Mo Kio Town Centre |0   |Females |  10| 2024|\n|Ang Mo Kio |Ang Mo Kio Town Centre |1   |Males   |  10| 2024|\n|Ang Mo Kio |Ang Mo Kio Town Centre |1   |Females |  10| 2024|\n|Ang Mo Kio |Ang Mo Kio Town Centre |2   |Males   |  10| 2024|\n|Ang Mo Kio |Ang Mo Kio Town Centre |2   |Females |  10| 2024|\n\n\n:::\n:::\n\n\n\n::: {.callout-note appearance=\"minimal\" collapse=\"true\"}\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(head(sg_data), n=10)\n```\n:::\n\n\n:::\n\n::: callout-warning\nAge looks like it should be a continuous variable but it is recognised as a categorical variable!\n:::\n\nThere are 91 unique values in the Age column. It ranges from 0 to 89 which are numeric but the last value consists of a string \"90_and_Over\". This is causing the Age column to be recognised as a categorical variable instead of a continuous variable.\n\n::: {.callout-note appearance=\"simple\" collapse=\"true\"}\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(sg_data$Age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"0\"           \"1\"           \"2\"           \"3\"           \"4\"          \n [6] \"5\"           \"6\"           \"7\"           \"8\"           \"9\"          \n[11] \"10\"          \"11\"          \"12\"          \"13\"          \"14\"         \n[16] \"15\"          \"16\"          \"17\"          \"18\"          \"19\"         \n[21] \"20\"          \"21\"          \"22\"          \"23\"          \"24\"         \n[26] \"25\"          \"26\"          \"27\"          \"28\"          \"29\"         \n[31] \"30\"          \"31\"          \"32\"          \"33\"          \"34\"         \n[36] \"35\"          \"36\"          \"37\"          \"38\"          \"39\"         \n[41] \"40\"          \"41\"          \"42\"          \"43\"          \"44\"         \n[46] \"45\"          \"46\"          \"47\"          \"48\"          \"49\"         \n[51] \"50\"          \"51\"          \"52\"          \"53\"          \"54\"         \n[56] \"55\"          \"56\"          \"57\"          \"58\"          \"59\"         \n[61] \"60\"          \"61\"          \"62\"          \"63\"          \"64\"         \n[66] \"65\"          \"66\"          \"67\"          \"68\"          \"69\"         \n[71] \"70\"          \"71\"          \"72\"          \"73\"          \"74\"         \n[76] \"75\"          \"76\"          \"77\"          \"78\"          \"79\"         \n[81] \"80\"          \"81\"          \"82\"          \"83\"          \"84\"         \n[86] \"85\"          \"86\"          \"87\"          \"88\"          \"89\"         \n[91] \"90_and_Over\"\n```\n\n\n:::\n:::\n\n\n:::\n\n# Fixing Data Issue\n\n::: {.callout-note appearance=\"simple\" collapse=\"true\"}\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsg_data$Age <- as.character(sg_data$Age)\n\nsg_data$Age[sg_data$Age == \"90_and_Over\"] <- \"90\"\n\nsg_data$Age <- as.numeric(sg_data$Age)\n\nsg_data$Age_Group <- cut(\n  sg_data$Age,\n  breaks = c(-1, 24, 64, Inf),\n  labels = c(\"Young\", \"Economically_Active\", \"Aged\"),\n  right = TRUE\n)\n\nunique(sg_data$Age_Group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] Young               Economically_Active Aged               \nLevels: Young Economically_Active Aged\n```\n\n\n:::\n:::\n\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|PA         |SZ                     | Age|Sex     | Pop| Time|Age_Group |\n|:----------|:----------------------|---:|:-------|---:|----:|:---------|\n|Ang Mo Kio |Ang Mo Kio Town Centre |   0|Males   |  10| 2024|Young     |\n|Ang Mo Kio |Ang Mo Kio Town Centre |   0|Females |  10| 2024|Young     |\n|Ang Mo Kio |Ang Mo Kio Town Centre |   1|Males   |  10| 2024|Young     |\n|Ang Mo Kio |Ang Mo Kio Town Centre |   1|Females |  10| 2024|Young     |\n|Ang Mo Kio |Ang Mo Kio Town Centre |   2|Males   |  10| 2024|Young     |\n|Ang Mo Kio |Ang Mo Kio Town Centre |   2|Females |  10| 2024|Young     |\n\n\n:::\n:::\n\n\n\n# Creating Demography Tables to show Percentage of Age Groups across Planning Areas\n\n::: {.callout-note appearance=\"simple\" collapse=\"true\"}\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndemography <- sg_data %>%\n  group_by(PA, Age_Group) %>%\n  summarise(Pop = sum(Pop, na.rm = TRUE)) %>%\n  tidyr::pivot_wider(\n    names_from = Age_Group,\n    values_from = Pop,\n    values_fill = 0\n  ) %>%\n  mutate(Total = Young + Economically_Active + Aged)\n\ndemography <- demography %>%\n  filter(Total > 0)\n\npct_demography <- demography %>%\n  mutate(\n    Pct_Young = (Young / Total) * 100,\n    Pct_Economically_Active = (Economically_Active / Total) * 100,\n    Pct_Aged = (Aged / Total) * 100\n  ) %>%\n  select(PA, Pct_Young, Pct_Economically_Active, Pct_Aged)\n\npct_demography <- pct_demography %>%\n  mutate(across(starts_with(\"pct\"), ~ round(.x, 1)))\n```\n:::\n\n\n:::\n\n::: panel-tabset\n\n## Young\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## Economically Active\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## Aged\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\npct_demography$PA <- factor(pct_demography$PA, levels = rev(sort(unique(pct_demography$PA))))\n\nggplot(data = pct_demography, \n       aes(x = PA, y = Pct_Young)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  theme_minimal() +\n  labs(\n    x = \"Planing Area\",  # Set a custom x-axis title\n    y = \"Percentage\"   # Set a custom y-axis title\n  ) +\n  ggtitle(\"Percentage of Young across Planning Area\")\n```\n:::\n\n\n:::",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}